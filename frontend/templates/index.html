{% extends "base.html" %}

{% block title %}Log Viewer{% endblock %}

{% block navbar %}
<form class="form-inline" action="">
	<input class="form-control mr-sm-2" type="text" placeholder="Search">
</form>
{% endblock %}

{% block content %}
<div style="margin: 50px;">
	<table class="table table-dark table-bordered table-striped">
		<thead class="container">
			<tr class="row">
				<th class="col-3">Title</th>
				<th class="col-3">Streamer</th>
				<th class="col-3">Started At</th>
				<th class="col-3">Game</th>
			</tr>
		</thead>
		<tbody class="container">
		</tbody>
	</table>
</div>

<div class="spinner-border text-light d-flex justify-content-center" style="margin-left: 50%; margin-top: 25%;" role="status">
	<span class="sr-only">Loading...</span>
</div>

<template>
	<tr class="row">
		<td class="col-3" scope="row">{{ title }}</td>
		<td class="col-3" name="streamer">{{ streamer }}</td>
		<td class="col-3">{{ startedAt }}</td>
		<td class="col-3">{{ Length }}</td>
	</tr>
</template>
{% endblock %}

{% block scripts %}
{% load static %}
<script src="{% static 'frontend/loadLogs.js' %}" type="text/javascript"></script>
<script>
	let search = $("input.form-control");
	//add event listener to the input event
	//input event fires whenever the text is changed
	search.on("input", function(){
		let table = $("table").find("tbody > tr"); //all table rows
		table.find("td").parent().hide(); //hide all table rows
		//only show rows where the text in the search box is contained in the streamer's name
		table.find("td[name^='streamer']").filter(function() {
			return $(this).text().toLocaleLowerCase().indexOf(search.val()) > -1; //custom case-insensitive search
		}).parent().show();
	});
</script>
{% endblock %}